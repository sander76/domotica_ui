<!doctype html>
<html>

<head>

    <title>Duomo</title>

    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
    <link rel="manifest" href="manifest.json">
    <script src="../bower_components/webcomponentsjs/webcomponents.min.js"></script>
    <script src="../bower_components/page.js/page.js"></script>
    <link rel="import" href="imports.html">
    <link rel="stylesheet" href="styles.css">

</head>

<body unresolved>


    <template is="auto-binding" id='app'>
        <core-scaffold>
            <core-header-panel navigation flex>
                <core-toolbar id="navheader">
                    <span>Menu</span>
                </core-toolbar>
                <core-menu valueattr="hash" selected="{{route}}">
                    <paper-item hash='lights'>
                        <a href="/lights">lights</a>
                    </paper-item>
                    <paper-item hash='connection'>
                        <a href="/connection">connection</a>
                    </paper-item>
                </core-menu>
            </core-header-panel>

            <span tool flex>Duomo</span>

            <div class="content">
                <core-pages valueattr="hash" selected="{{route}}">
                    <section hash='lights' layout vertical>
                        
                        <mqtt-parent topics="{{topics}}"></mqtt-parent>
                        
                    </section>

                    <section hash='connection' layout vertical>
                        <mqtt-service id="mqttserv" host="test.mosquitto.org" topics='{{topics}}' client="test.mosquitto.org" port="8080" debug="true"></mqtt-service>
                    </section>


                </core-pages>

            </div>
        </core-scaffold>
    </template>
    <script>
        var app = document.querySelector("#app");

        
        //todo: this data binding doesn't seem to work.
//        app.light1 = {
//            topic: "lights/1",
//            name: "light 1"
//        }
//        app.light2 = {
//            topic: "lights/2",
//            name: "light 2"
//        }
        app.topics = [{topic:"lights1",name:"light 1"},{topic:"lights2",name:"light 2"}];

        //define routing
        page('/lights', lights);
        page('/connection', other);

        function lights() {
            app.route = 'lights';
        }

        function other() {
            app.route = 'connection';
        }

        page({
            hashbang: true
        });
    </script>
</body>

</html>